def A = false
def B = true
pipeline {
    agent any
    stages {
        stage('Build Stage') {
            steps {
                jdk = tool 'JDK' //get path of JDK installation with the name Java8 in Global Tool Configuration
                env.JAVA_HOME = jdk  //set JAVA_HOME environment variable
                echo "jdk installation path is: ${jdk}"
                logJavaVersion()
                env.PATH = "${env.JAVA_HOME}/bin:${env.PATH}"  //add to PATH environment variable
                mvnHome = tool 'MVN'  //get path of MVN installation with the name Maven in Global Tool Configuration
                logMavenVersion()
                git "https://github.com/nishantautomationlabs/nal-junitmockito.git"
                sh "mvn -U clean compile install -DskipTests"
                echo 'Build Stage executed'
            }
        }
        stage('Unit Test Stage') {
            steps {
                sh "mvn test"
                echo 'Unit Test Stage executed'
            }
        }
        stage('Master Stage'){
            when{
                branch 'master'
            }
            steps {
                echo 'run this stage only if its running on the master branch'
            }
        }
        stage('Conditional Stage') {
            when {
                expression { return A || B }
            }
            steps {
                echo 'Conditional stage executed'
            }
        }
        stage('Manual Sign Off') {
            steps {
                echo 'Run manual sign off and click proceed to go to deployment'
                input('Do you want to proceed?')
            }
        }
        stage('Deployment stage') {
            steps {
                echo 'Deployed the build successfully'
            }
        }
    }
}

private void logJavaVersion() {
    println "using Java Version : "
    sh "java -version"
}

private void logMavenVersion() {
    println "using Maven Version : "
    sh "mvn --version"
}